colnames(SBK) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(SLM) = c("date","Returns", "Returns_sqd", "Returns_abs")
Rtn <- log(1 + rtn/100)*100
Rtn <- Rtn %>% xts_tbl() %>% gather(Ticker, Return, -date)
source("code/arch_calc.R")
ABSP <- arch_calc("JSE.ABSP.Close")
BVT <- arch_calc("JSE.BVT.Close")
FSR <- arch_calc("JSE.FSR.Close")
NBKP <- arch_calc("JSE.NBKP.Close")
RMH <- arch_calc("JSE.RMH.Close")
SBK <- arch_calc("JSE.SBK.Close")
SLM <- arch_calc("JSE.SLM.Close")
colnames(ABSP) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(BVT) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(FSR) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(NBKP) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(RMH) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(SBK) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(SLM) = c("date","Returns", "Returns_sqd", "Returns_abs")
View(Rtn)
View(ABSP)
View(BVT)
View(FSR)
Rtn <- log(1 + rtn/100)*100
Rtn <- Rtn %>% xts_tbl() %>% gather(Ticker, Return, -date)
source("code/arch_calc.R")
ABSP <- arch_calc("JSE.ABSP.Close")
BVT <- arch_calc("JSE.BVT.Close")
FSR <- arch_calc("JSE.FSR.Close")
NBKP <- arch_calc("JSE.NBKP.Close")
RMH <- arch_calc("JSE.RMH.Close")
SBK <- arch_calc("JSE.SBK.Close")
SLM <- arch_calc("JSE.SLM.Close")
colnames(ABSP) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(BVT) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(FSR) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(NBKP) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(RMH) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(SBK) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(SLM) = c("date","Returns", "Returns_sqd", "Returns_abs")
View(ABSP)
Rtn <- log(1 + rtn/100)*100
Rtn <- Rtn %>% xts_tbl() %>% gather(Ticker, Return, -date)
source("code/arch_calc.R")
ABSP <- arch_calc("JSE.ABSP.Close")
BVT <- arch_calc("JSE.BVT.Close")
FSR <- arch_calc("JSE.FSR.Close")
NBKP <- arch_calc("JSE.NBKP.Close")
RMH <- arch_calc("JSE.RMH.Close")
SBK <- arch_calc("JSE.SBK.Close")
SLM <- arch_calc("JSE.SLM.Close")
colnames(ABSP) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(BVT) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(FSR) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(NBKP) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(RMH) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(SBK) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(SLM) = c("date","Returns", "Returns_sqd", "Returns_abs")
source("code/arch_plot.R")
plot1 <- arch_plot(ABSP)
View(plotdata)
View(ABSP)
View(ABSP)
View(rtn)
View(Rtn)
Rtn <- Rtn %>% xts_tbl(date = as.Date(Rtn$date, format= "%Y-%m-%d")) %>% gather(Ticker, Return, -date)
Rtn <- Rtn %>% xts_tbl(Rtn, as.Date(Rtn$date, format= "%Y-%m-%d")) %>% gather(Ticker, Return, -date)
Rtn <- Rtn %>% xts_tbl(xts = Rtn, as.Date(Rtn$date, format= "%Y-%m-%d")) %>% gather(Ticker, Return, -date)
Rtn <- Rtn %>% xts_tbl(xts = Rtn, as.Date(Rtn$date, format= "%Y-%m-%d")) %>% gather(Ticker, Return, -date)
Rtn <- log(1 + rtn/100)*100
Rtn <- Rtn %>% xts_tbl(xts = Rtn, as.Date(Rtn$date, format= "%Y-%m-%d"))
View(Rtn)
View(Rtn)
Rtn <- Rtn %>% xts_tbl(xts = Rtn, as.Date(format= "%Y-%m-%d")) %>% gather(Ticker, Return, -date)
Rtn <- Rtn %>% xts_tbl() %>% gather(Ticker, Return, -date)
View(Rtn)
Rtn <- (Rtn$date, as.Date(format= "%Y-%m-%d"))
as.Date(x = Rtn$date, format= "%Y-%m-%d")
View(Rtn)
Rtn <- log(1 + rtn/100)*100
Rtn <- Rtn %>% xts_tbl() %>% gather(Ticker, Return, -date)
as.Date(x = Rtn$date, format= "%Y-%m-%d")
source("code/arch_calc.R")
ABSP <- arch_calc("JSE.ABSP.Close")
BVT <- arch_calc("JSE.BVT.Close")
FSR <- arch_calc("JSE.FSR.Close")
NBKP <- arch_calc("JSE.NBKP.Close")
RMH <- arch_calc("JSE.RMH.Close")
SBK <- arch_calc("JSE.SBK.Close")
SLM <- arch_calc("JSE.SLM.Close")
colnames(ABSP) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(BVT) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(FSR) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(NBKP) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(RMH) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(SBK) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(SLM) = c("date","Returns", "Returns_sqd", "Returns_abs")
View(RMH)
source("code/arch_plot.R")
plot1 <- arch_plot(ABSP)
View(plotdata)
Rtn <- log(1 + rtn/100)*100
Rtn <- Rtn %>% xts_tbl() %>% gather(Ticker, Return, -date)
as.Date(x = Rtn$date, format= "%Y-%m-%d")
Rtn$date <- as.Date(x = Rtn$date, format= "%Y-%m-%d")
View(Rtn)
Rtn <- log(1 + rtn/100)*100
Rtn <- Rtn %>% xts_tbl() %>% gather(Ticker, Return, -date)
Rtn$date <- as.Date(x = Rtn$date, format= "%Y-%m-%d")
source("code/arch_calc.R")
ABSP <- arch_calc("JSE.ABSP.Close")
BVT <- arch_calc("JSE.BVT.Close")
FSR <- arch_calc("JSE.FSR.Close")
NBKP <- arch_calc("JSE.NBKP.Close")
RMH <- arch_calc("JSE.RMH.Close")
SBK <- arch_calc("JSE.SBK.Close")
SLM <- arch_calc("JSE.SLM.Close")
colnames(ABSP) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(BVT) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(FSR) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(NBKP) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(RMH) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(SBK) = c("date","Returns", "Returns_sqd", "Returns_abs")
colnames(SLM) = c("date","Returns", "Returns_sqd", "Returns_abs")
View(ABSP)
source("code/arch_plot.R")
plot1 <- arch_plot(ABSP)
View(plotdata)
View(SLM)
Rtn$date = as.Date(x = Rtn$date, format= "%Y-%m-%d")
View(Rtn)
Rtn$date <-  as.Date(x = Rtn$date, format = format="%Y-%m-%d")
plotdata <- ABSP %>% gather(Returntype, returns, -date)
View(plotdata)
plot1 <- arch_plot(ABSP)
plot1
source("code/arch_plot.R")
plot1 <- arch_plot(ABSP)
plot1
View(plotdata)
source("code/arch_plot.R")
plot1 <- arch_plot(ABSP)
plot1
source("code/arch_plot.R")
plot1 <- arch_plot(ABSP)
plot1
source("code/arch_plot.R")
plot1 <- arch_plot(ABSP)
source("code/arch_plot.R")
plot1 <- arch_plot(ABSP)
source("code/arch_plot.R")
plot_absp <- arch_plot(ABSP)
plot_bvt <- arch_plot(BVT)
plot_fsr <- arch_plot(FSR)
plot_nbkp <- arch_plot(NBPK)
plot_rmh <- arch_plot(RMH)
plot_sbk <- arch_plot(SBK)
plot_slm <- arch_plot(SLM)
source("code/arch_plot.R")
plot_absp <- arch_plot(ABSP)
plot_bvt <- arch_plot(BVT)
plot_fsr <- arch_plot(FSR)
plot_nbkp <- arch_plot(NBKP)
plot_rmh <- arch_plot(RMH)
plot_sbk <- arch_plot(SBK)
plot_slm <- arch_plot(SLM)
plot_nbkp
View(plot_bvt)
unique(Rtn$Ticker)
load_pkg(c("tidyverse", "devtools", "rugarch", "forecast", "tbl2xts",
"lubridate", "PerformanceAnalytics", "MTS", "ggthemes","xtable"))
library(rmsfuns)
load_pkg(c("tidyverse", "devtools", "rugarch", "forecast", "tbl2xts",
"lubridate", "PerformanceAnalytics", "MTS", "ggthemes","xtable"))
data_adj <- dailydata %>%
gather(Stocks, Price, -Date) %>%
arrange(Date) %>%
group_by(Stocks) %>%
mutate(Returns = Price/lag(Price) -1 ) %>% ungroup()
CumRet <- data_adj %>%
mutate(Returns = coalesce(Returns, 0)) %>%
group_by(Stocks) %>%
mutate(Cum_ret = cumprod(1+Returns))
data_adj <- dailydata %>%
gather(Stocks, Price, -Date) %>%
arrange(Date) %>%
group_by(Stocks) %>%
mutate(Returns = Price/lag(Price) -1 ) %>% ungroup()
CumRet <- data_adj %>%
mutate(Returns = coalesce(Returns, 0)) %>%
group_by(Stocks) %>%
mutate(Cum_ret = cumprod(1+Returns))
w_xts <- data_adj %>%
filter(Date == first(Date)) %>%
mutate(weight = 1/n()) %>%
tbl_xts(., cols_to_xts = "weight", spread_by = "Stocks")
R_xts <- data_adj %>%
tbl_xts(.,cols_to_xts = "Returns", spread_by = "Stocks")
Portfolio <-
Return.portfolio(R = R_xts, weights = W_xts, geometric = T)
Portf_Rets <- Portfolio$portfolio.returns %>% xts_tbl()
data_adj <- dailydata %>%
gather(Stocks, Price, -Date) %>%
arrange(Date) %>%
group_by(Stocks) %>%
mutate(Returns = Price/lag(Price) -1 ) %>% ungroup()
View(data_adj)
View(dailydata)
View(CumRet)
data_adj <- dailydata %>%
gather(Stocks, Price, -Date) %>%
arrange(Date) %>%
group_by(Stocks) %>%
mutate(Returns = Price/lag(Price) -1 ) %>% ungroup()
CumRet <- data_adj %>%
mutate(Returns = coalesce(Returns, 0)) %>%
group_by(Stocks) %>%
mutate(Cum_ret = cumprod(1+Returns))
w_xts <- data_adj %>%
filter(Date == first(Date)) %>%
mutate(weight = 1/n()) %>%
tbl_xts(., cols_to_xts = "weight", spread_by = "Stocks")
R_xts <- data_adj %>%
tbl_xts(.,cols_to_xts = "Returns", spread_by = "Stocks")
Portfolio <-
Return.portfolio(R = R_xts, weights = w_xts, geometric = T)
Portf_Rets <- Portfolio$portfolio.returns %>% xts_tbl()
View(Portf_Rets)
View(Portfolio)
View(Portf_Rets)
View(Portf_Rets)
View(Portfolio)
View(Portf_Rets)
portf_plot <- ggplot(data = Portf_Rets)+
geom_line(aes(x = date, y = portfolio.returns, alpha = 0.5)) +
ggtitle("Portfolio returns") +
guides(alpha=FALSE, colour = FALSE) +
theme_fivethirtyeight()
portf_plot
plot_fsr
portf_plot <- ggplot(data = Portf_Rets)+
geom_line(aes(x = date, y = portfolio.returns)) +
ggtitle("Portfolio returns") +
guides(alpha=FALSE, colour = FALSE) +
theme_fivethirtyeight()
portf_plot
View(w_xts)
w_xts <- data_adj %>%
filter(Date == "%Y-06-30") %>%
mutate(weight = 1/n()) %>%
tbl_xts(., cols_to_xts = "weight", spread_by = "Stocks")
install.packages("rportfolios")
load_pkg(c("tidyverse", "devtools", "rugarch", "forecast", "tbl2xts",
"lubridate", "PerformanceAnalytics", "MTS", "ggthemes","xtable", "rportfolios"))
View(R_xts)
data_adj <- dailydata %>%
gather(Stocks, Price, -Date)
RebMonths <- 7
RandomWeights <-
data_adj %>%
mutate(Months = as.double(format(Date, format = "%m")),
YearMonths = as.double(format(Date, format = "%Y%m"))) %>%
filter(Months %in% RebMonths) %>%
group_by(YearMonths, Months, Stocks) %>% filter(Date == last(Date)) %>% ungroup()
View(RandomWeights)
RandomWeights_adj <-
bind_cols(RandomWeights %>% arrange(Date),
RandomWeights %>% group_by(Date) %>%
do( Randweights = random.bounded(n = nrow(.),
x.t = 1, # Full investment...
x.l = rep(0, nrow(.)), # Lower Bound
x.u = rep(0.09, nrow(.)),
max.iter = 1000) ) %>% ungroup() %>% unnest()
)
View(RandomWeights)
RandomWeights <-
data_adj %>%
mutate(Months = as.double(format(Date, format = "%m")),
YearMonths = as.double(format(Date, format = "%Y%m"))) %>%
filter(Months %in% RebMonths) %>%
group_by(YearMonths, Months, Stocks) %>% filter(Date == last(Date)) %>% ungroup()
Equal_weights <-
RandomWeights %>%
group_by(Date) %>%
mutate(EqualWeights = 1/n()) %>% ungroup() %>% select(-Months, -YearMonths, -Date1)
Equal_weights <-
RandomWeights %>%
group_by(Date) %>%
mutate(EqualWeights = 1/n()) %>% ungroup() %>% select(-Months, -YearMonths, -Date)
View(Equal_weights)
View(RandomWeights)
Fund_Size_at_Start <- 1000
EW_weights <- Equal_weights %>% spread(Stocks, EqualWeights) %>% tbl_xts()
View(Equal_weights)
data_adj <- dailydata %>%
gather(Stocks, Price, -Date)
RebMonths <- 7
RandomWeights <-
data_adj %>%
mutate(Months = as.double(format(Date, format = "%m")),
YearMonths = as.double(format(Date, format = "%Y%m"))) %>%
filter(Months %in% RebMonths) %>%
group_by(YearMonths, Months, Stocks) %>% filter(Date == last(Date)) %>% ungroup() %>%
arrange(Date) %>% group_by(Date)
Equal_weights <-
RandomWeights %>%
group_by(Date) %>%
mutate(EqualWeights = 1/n()) %>% ungroup() %>% select(-Months, -YearMonths, -Date)
View(Equal_weights)
View(RandomWeights)
RandomWeights <-
data_adj %>%
mutate(Months = as.double(format(Date, format = "%m")),
YearMonths = as.double(format(Date, format = "%Y%m"))) %>%
filter(Months %in% RebMonths) %>%
group_by(YearMonths, Stocks) %>% filter(Date == last(Date)) %>% ungroup() %>%
arrange(Date) %>% group_by(Date)
Equal_weights <-
RandomWeights %>%
group_by(Date) %>%
mutate(EqualWeights = 1/n()) %>% ungroup() %>% select(-Months, -YearMonths, -Date)
View(Equal_weights)
RandomWeights <-
data_adj %>%
mutate(Months = as.double(format(Date, format = "%m")),
YearMonths = as.double(format(Date, format = "%Y%m"))) %>%
filter(Months %in% RebMonths) %>%
group_by(YearMonths, Stocks) %>% #filter(Date == last(Date)) %>%
ungroup() %>%
arrange(Date) %>% group_by(Date)
View(RandomWeights)
RandomWeights <-
data_adj %>%
mutate(Months = as.double(format(Date, format = "%m")),
YearMonths = as.double(format(Date, format = "%Y%m"))) %>%
filter(Months %in% RebMonths) %>%
group_by(YearMonths, Stocks) %>% filter(Date == last(Date)) %>%
ungroup() %>%
arrange(Date) %>% group_by(Date)
EW_weights <- Equal_weights %>% spread(Stocks, EqualWeights) %>% tbl_xts()
View(Equal_weights)
data_adj <- dailydata %>%
gather(Stocks, Price, -Date)
RebMonths <- 7
RandomWeights <-
data_adj %>%
mutate(Months = as.double(format(Date, format = "%m")),
YearMonths = as.double(format(Date, format = "%Y%m"))) %>%
filter(Months %in% RebMonths) %>%
group_by(YearMonths, Stocks) %>% filter(Date == last(Date)) %>%
ungroup() %>%
arrange(Date) %>% group_by(Date)
Equal_weights <-
RandomWeights %>%
group_by(Date) %>%
mutate(EqualWeights = 1/n()) %>% ungroup() %>% select(-Months, -YearMonths)
View(Equal_weights)
Fund_Size_at_Start <- 1000
EW_weights <- Equal_weights %>% spread(Stocks, EqualWeights) %>% tbl_xts()
View(EW_weights)
View(Equal_weights)
EW_weights <- Equal_weights %>%
select(Date, Stocks, EqualWeights) %>%
spread(Stocks, EqualWeights) %>% tbl_xts()
df_Returns <- data_adj %>% spread(Stocks, Returns)
df_Returns[is.na(df_Returns)] <- 0
xts_df_Returns <- df_Returns %>% tbl_xts()
df_Returns <- data_adj %>% spread(Stocks, Returns)
View(data_adj)
View(dailydata)
data_adj <- dailydata %>%
gather(Stocks, Price, -Date) %>%
group_by(Stocks) %>%
mutate(Returns = Price/lag(Price) - 1)
RebMonths <- 7
RandomWeights <-
data_adj %>%
mutate(Months = as.double(format(Date, format = "%m")),
YearMonths = as.double(format(Date, format = "%Y%m"))) %>%
filter(Months %in% RebMonths) %>%
group_by(YearMonths, Stocks) %>% filter(Date == last(Date)) %>%
ungroup() %>%
arrange(Date) %>% group_by(Date)
Equal_weights <-
RandomWeights %>%
group_by(Date) %>%
mutate(EqualWeights = 1/n()) %>% ungroup() %>% select(-Months, -YearMonths)
Fund_Size_at_Start <- 1000
EW_weights <- Equal_weights %>%
select(Date, Stocks, EqualWeights) %>%
spread(Stocks, EqualWeights) %>% tbl_xts()
df_Returns <- data_adj %>% spread(Stocks, Returns)
df_Returns[is.na(df_Returns)] <- 0
xts_df_Returns <- df_Returns %>% tbl_xts()
View(df_Returns)
View(Equal_weights)
load_pkg("TTR")
data_adj <- dailydata %>% arrange(Date) %>% mutate_at(.vars = vars(-Date),
.funs = funs(ROC(., type = c("continuous", "discrete")[2]))) %>%
mutate_at(.vars = vars(-Date), funs(na.locf(., na.rm = F, maxgap = 5)))
data_adj <- dailydata %>%
gather(Stocks, Price, -Date) %>%
group_by(Stocks) %>%
mutate(Returns = Price/lag(Price) - 1)
data_adj <- dailydata %>% arrange(Date) %>% mutate_at(.vars = vars(-Date),
.funs = funs(ROC(., type = c("continuous", "discrete")[2]))) %>%
mutate_at(.vars = vars(-Date), funs(na.locf(., na.rm = F, maxgap = 5)))
data_adj <- data_adj %>%
gather(Stocks, Returns, -Date)
View(data_adj)
RebMonths <- 7
RandomWeights <-
data_adj %>%
mutate(Months = as.double(format(Date, format = "%m")),
YearMonths = as.double(format(Date, format = "%Y%m"))) %>%
filter(Months %in% RebMonths) %>%
group_by(YearMonths, Stocks) %>% filter(Date == last(Date)) %>%
ungroup() %>%
arrange(Date)
Equal_weights <-
RandomWeights %>%
group_by(Date) %>%
mutate(EqualWeights = 1/n()) %>% ungroup() %>% select(-Months, -YearMonths)
Fund_Size_at_Start <- 1000
EW_weights <- Equal_weights %>%
select(Date, Stocks, EqualWeights) %>%
spread(Stocks, EqualWeights) %>% tbl_xts()
df_Returns <- data_adj %>% spread(Stocks, Returns)
df_Returns[is.na(df_Returns)] <- 0
xts_df_Returns <- df_Returns %>% tbl_xts()
View(xts_df_Returns)
View(w_xts)
View(EW_weights)
EW_RetPort <- Return.portfolio(xts_df_Returns, weights = EW_weights,
verbose = TRUE, contribution = TRUE, value = Fund_Size_at_Start,
geometric = TRUE)
View(EW_RetPort)
EW_Contribution <- EW_RetPort$contribution %>% xts_tbl() %>%
mutate(date = lag(date), date = coalesce(date, index(EW_weights)[1]))
EW_BPWeight <- EW_RetPort$BOP.Weight %>% xts_tbl() %>% mutate(date = lag(date),
date = coalesce(date, index(EW_weights)[1]))
EW_BPValue <- EW_RetPort$BOP.Value %>% xts_tbl() %>% mutate(date = lag(date),
date = coalesce(date, index(EW_weights)[1]))
names(EW_Contribution) <- c("date", names(Rand_RetPort$contribution))
names(EW_BPWeight) <- c("date", names(Rand_RetPort$BOP.Weight))
names(EW_BPValue) <- c("date", names(Rand_RetPort$BOP.Value))
View(EW_BPValue)
View(EW_BPWeight)
EW_Contribution <- EW_RetPort$contribution %>% xts_tbl() %>%
mutate(date = lag(date), date = coalesce(date, index(EW_weights)[1]))
EW_BPWeight <- EW_RetPort$BOP.Weight %>% xts_tbl() %>% mutate(date = lag(date),
date = coalesce(date, index(EW_weights)[1]))
EW_BPValue <- EW_RetPort$BOP.Value %>% xts_tbl() %>% mutate(date = lag(date),
date = coalesce(date, index(EW_weights)[1]))
View(EW_BPValue)
View(EW_Contribution)
View(EW_RetPort)
View(EW_Contribution)
View(EW_BPWeight)
View(EW_BPValue)
df_port_return_EW <- left_join(data_adj %>% rename(date = Date),
EW_BPWeight %>% gather(Stocks, weight, -date), by = c("date",
"Stocks")) %>% left_join(., EW_BPValue %>% gather(Stocks,
value_held, -date), by = c("date", "Stocks")) %>% left_join(.,
EW_Contribution %>% gather(Stocks, Contribution, -date),
by = c("date", "Stocks"))
View(df_port_return_EW)
View(df_port_return_EW)
test <- na.omit(df_port_return_EW)
View(test)
df_port_return_EW <- left_join(data_adj %>% rename(date = Date),
EW_BPWeight %>% gather(Stocks, weight, -date), by = c("date",
"Stocks")) %>% left_join(., EW_BPValue %>% gather(Stocks,
value_held, -date), by = c("date", "Stocks")) %>% left_join(.,
EW_Contribution %>% gather(Stocks, Contribution, -date),
by = c("date", "Stocks")) %>%
na.omit(df_port_return_EW)
View(df_port_return_EW)
df_Portf_EW <- df_port_return_EW %>% group_by(date) %>% summarise(PortfolioReturn = sum(Returns *
weight, na.rm = TRUE)) %>% filter(PortfolioReturn != 0)
View(df_Portf_EW)
portf_plot <- ggplot(data = df_Portf_EW)+
geom_line(aes(x = date, y = PortfolioReturn)) +
ggtitle("Portfolio returns") +
guides(alpha=FALSE, colour = FALSE) +
theme_fivethirtyeight()
portf_plot
portf_plot <- ggplot(data = df_Portf_EW)+
geom_line(aes(x = date, y = PortfolioReturn)) +
ggtitle("Portfolio returns") +
guides(alpha=FALSE, colour = FALSE) +
theme_fivethirtyeight()
portf_plot
rm(portf_plot)
portf_plot <- ggplot(data = df_Portf_EW)+
geom_line(aes(x = date, y = PortfolioReturn)) +
ggtitle("Portfolio returns") +
guides(alpha=FALSE, colour = FALSE) +
theme_fivethirtyeight()
portf_plot
Cum_EW <- df_Portf_EW %>% mutate(cumreturn_EW = (cumprod(1 +
PortfolioReturn) - 1)) %>% mutate(wealthindex_EW = 100 *
(cumprod(1 + PortfolioReturn))) %>% select(-PortfolioReturn)
View(Cum_EW)
portf_plot <- ggplot(data = Cum_EW)+
geom_line(aes(x = date, y = wealthindex_EW)) +
ggtitle("Portfolio returns") +
guides(alpha=FALSE, colour = FALSE) +
theme_fivethirtyeight()
portf_plot
source("code/portfolio_plot.R")
print(portf_plot)
